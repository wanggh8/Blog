---
title: 数据挖掘第一次作业
date: 2019-03-17 13:59:29
tags: 数据挖掘
---

**蒙特卡罗方法**（英语：Monte Carlo method），也称**统计模拟方法**，是指使用随机数（或更常见的伪随机数）来解决很多计算问题的方法。在解决实际问题的时候应用蒙特卡罗方法主要有两部分工作：

1. 用蒙特卡罗方法模拟某一过程时，需要产生各种概率分布的随机变量。
2. 用统计方法把模型的数字特征估计出来，从而得到实际问题的数值解。

蒙特卡洛算法也常用于机器学习，特别是强化学习的算法中。一般情况下，针对得到的样本数据集创建相对模糊的模型，通过蒙特卡洛方法对于模型中的参数进行选取，使之于原始数据的残差尽可能的小。从而达到创建模型拟合样本的目的。

<!--more--> 

## Exercise 1

**简述：**蒙特卡罗方法可用于近似计算圆周率：让计算机每次随机生成两个0到1之间的数，看以这两个实数为横纵坐标的点是否在单位圆内。生成一系列随机点，统计单位圆内的点数与总点数，（圆面积和正方形面积之比为PI:4，PI为圆周率），当随机点获取越多时，其结果越接近于圆周率。

**实验过程：**重复次数设为50，使用matlab实现，代码：

**myPi.m**

```matlab
function [means,variances] = myPi(num)
    % num: 随机样本数
    % 使用蒙特卡洛方法求pi
    my_pi = zeros(1,50);
    for t=1:50     
        %% 生成随机数
        s=rng;
        rng(s);
        point=2*rand(2,num);   
        %% 统计落入圆中的点
        total_in=0;
        for i=1:num
            if sqrt((point(1,i)-1)^2+(point(2,i)-1)^2) < 1
                total_in=total_in+1;
            end
        end     
       %% 计算pi
        my_pi(t)=total_in/num*4;
    end
    means = mean(my_pi);
    variances = std(my_pi,0,2)^2;
end   
```

**exercise1.m**

```matlab
number = [ 20,50,100,200,300,500,1000,5000];
result = zeros(2,8);
for i=1:8
   [result(1,i),result(2,i)] = myPi(number(i));
end
result
```

#### **实验结果：**

|      |   20   | 50     | 100    | 200    | 300    | 500    | 1000   | 5000   |
| ---- | :----: | ------ | ------ | ------ | ------ | ------ | ------ | ------ |
| 均值 | 3.1400 | 3.1232 | 3.2000 | 3.1412 | 3.1099 | 3.1371 | 3.1297 | 3.1407 |
| 方差 | 0.0886 | 0.0580 | 0.0269 | 0.0125 | 0.0096 | 0.0061 | 0.0023 | 0.0006 |

## Exercise 2

**简述：**使用蒙特卡洛方法求定积分，非权重蒙特卡罗积分，也称确定性抽样，是对被积函数变量区间进行随机均匀抽样，然后对抽样点的函数值求平均，从而可以得到函数积分的近似值。此种方法的正确性是基于概率论的中心极限定理。当抽样点数为m时，使用此种方法所得近似解的统计误差只与m有关，不随积分维数的改变而改变。因此当积分维度较高时，蒙特卡罗方法相对于其他数值解法更优。大致方法有：

1. 随机投点法（最常用）
2. 期望法（平均值法）

**实验过程：**x使用均分分布采样，这样能保证在边长为1的正方形中各个位置的概率相等，重复次数设为100, matlab代码：

**x3.m**

```matlab
function [means,variances] = x3(num)
    % num: 随机样本数
    % 使用蒙特卡罗方法求定积分
    my_res = zeros(1,100);
    for t=1:100     
        %% 生成随机数
        s=rng;
        rng(s);
        point=rand(2,num);   
        %% 统计线下面的点
        total_in=0;
        for i=1:num
            if (point(1,i))^3 > point(2,i)
                total_in=total_in+1;
            end
        end     
       %% 计算结果
        my_res(t)=total_in/num;
    end
    means = mean(my_res);
    variances = std(my_res,0,2)^2;
end
```

**exercise2.m**

```matlab
number = [ 5, 10, 20, 30, 40, 50, 60, 70, 80,100];
result = zeros(2,10);
for i=1:10
   [result(1,i),result(2,i)] = x3(number(i));
end
result
```

#### 实验结果：

|      |   5    |   10   |   20   |   30   |   40    |
| :--: | :----: | :----: | :----: | :----: | :-----: |
| 均值 | 0.2660 | 0.2540 | 0.2460 | 0.2563 | 0.2387  |
| 方差 | 0.0413 | 0.0175 | 0.0101 | 0.0061 | 0.0043  |
|      | **50** | **60** | **70** | **80** | **100** |
| 均值 | 0.2502 | 0.2465 | 0.2539 | 0.2616 | 0.2479  |
| 方差 | 0.0041 | 0.0026 | 0.0029 | 0.0025 | 0.0022  |

## Exercise 3

不能使用公式直接获得，使用蒙特卡洛方法求定积分，方法为随机投点法

x使用均分分布采样，重复次数设为100, matlab代码：

**func3.m**

```matlab
function [means,variances] = func3(num)
    % num: 随机样本数
    % 使用蒙特卡洛方法求定积分
    my_res = zeros(1,100);
    for t=1:100     
        %% 生成随机数
        s=rng;
        rng(s);
        x=2+2*rand(1,num);
        y=-1+2*rand(1,num);
        z=800000*rand(1,num);
        %% 统计线下面的点
        total_in=0;
        for i=1:num
            d = (y(1,i)^2*exp(-y(1,i)^2 )+x(1,i)^4*exp(-x(1,i)^2 ))/(x(1,i)*exp(-x(1,i)^2 ) );
            if z(1,i) < d
                total_in=total_in+1;
            end
        end  
        
       %% 计算结果
        my_res(t)=2*2*800000*total_in/num;
    end
    means = mean(my_res);
    variances = std(my_res,0,2)^2;
end
```

**exercise3.m**

```matlab
format long
number = [10, 20, 30, 40, 50, 60, 70, 80,100,200,500];
result = zeros(2,11);

for i=1:11
   [result(1,i),result(2,i)] = func3(number(i));
end
result
```

#### **实验结果：**

| 采样次数N |            均值            |            方差            |
| :-------: | :------------------------: | :------------------------: |
|    10     | 1.0e+10 *0.000010560000000 | 1.0e+10 *3.735014141414141 |
|    20     | 1.0e+10 *0.000009600000000 | 1.0e+10 *1.603232323232323 |
|    30     | 1.0e+10 *0.000011946666667 | 1.0e+10 *1.109735578002245 |
|    40     | 1.0e+10 *0.000011760000000 | 1.0e+10 *0.833357575757576 |
|    50     | 1.0e+10 *0.000011648000000 | 1.0e+10 *0.632025212121212 |
|    60     | 1.0e+10 *0.000010400000000 | 1.0e+10 *0.559551066217732 |
|    70     | 1.0e+10 *0.000011337142857 | 1.0e+10 *0.538196330653474 |
|    80     | 1.0e+10 *0.000010840000000 | 1.0e+10 *0.401761616161616 |
|    100    | 1.0e+10 *0.000010816000000 | 1.0e+10 *0.409144888888889 |
|    200    | 1.0e+10 *0.000010640000000 | 1.0e+10 *0.132072727272727 |
|    500    | 1.0e+10 *0.000011353600000 | 1.0e+10 *0.058057283232323 |